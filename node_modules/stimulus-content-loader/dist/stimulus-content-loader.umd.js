(function(t,s){typeof exports=="object"&&typeof module!="undefined"?module.exports=s(require("@hotwired/stimulus")):typeof define=="function"&&define.amd?define(["@hotwired/stimulus"],s):(t=typeof globalThis!="undefined"?globalThis:t||self,t["stimulus-content-loader"]=s(t.Stimulus))})(this,function(t){"use strict";class s extends t.Controller{connect(){if(!this.hasUrlValue){console.error("[stimulus-content-loader] You need to pass an url to fetch the remote content.");return}this.hasLazyLoadingValue?this.lazyLoad():this.load()}disconnect(){this.stopRefreshing()}load(){this.fetch(),this.hasRefreshIntervalValue&&this.startRefreshing()}lazyLoad(){const e={threshold:this.lazyLoadingThresholdValue,rootMargin:this.lazyLoadingRootMarginValue};new IntersectionObserver((n,o)=>{n.forEach(i=>{i.isIntersecting&&(this.load(),o.unobserve(i.target))})},e).observe(this.element)}fetch(){fetch(this.urlValue).then(e=>e.text()).then(e=>{this.element.innerHTML=e,this.loadScriptsValue&&this.loadScripts()})}startRefreshing(){this.refreshTimer=setInterval(()=>{this.fetch()},this.refreshIntervalValue)}stopRefreshing(){this.refreshTimer&&clearInterval(this.refreshTimer)}loadScripts(){this.element.querySelectorAll("script").forEach(e=>{const r=document.createElement("script");r.innerHTML=e.innerHTML,document.head.appendChild(r).parentNode.removeChild(r)})}}return s.values={url:String,lazyLoading:Boolean,lazyLoadingThreshold:Number,lazyLoadingRootMargin:{type:String,default:"0px"},refreshInterval:Number,loadScripts:Boolean},s});
